(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-716021ed"],{"365c":function(e,t,n){"use strict";n("a481");var r=n("bc3a"),a=n.n(r),o=n("3786"),s=n("41cb"),i=n("c0d6"),c=n("a026"),u="",l={baseURL:u+"/api"},f=a.a.create(l),m=a.a.create(),d=i["a"];f.interceptors.request.use((function(e){var t=new Date,n=new Date(Date.parse(d.state.tokenExpire));return d.state.token&&t<n&&d.state.tokenExpire&&(e.headers.Authorization="Bearer "+d.state.token),p(),e}),(function(e){return Promise.reject(e)})),f.interceptors.response.use((function(e){return e}),(function(e){var t=e.config;if("ECONNABORTED"==e.code&&-1!=e.message.indexOf("timeout")&&!t._retry)return c["default"].prototype.$message({message:"请求超时！",type:"error"}),t._retry=!0,null;if(e.response){if(401==e.response.status){var n=new Date,r=new Date(Date.parse(window.localStorage.refreshtime));if(window.localStorage.refreshtime&&n<=r)return o["a"].refreshToken({token:window.localStorage.Token}).then((function(t){if(t.success){c["default"].prototype.$message({message:"refreshToken success! loading data...",type:"success"}),i["a"].commit("saveToken",t.token);var n=new Date,r=new Date(n.setSeconds(n.getSeconds()+t.expires_in));return i["a"].commit("saveTokenExpire",r),e.config.__isRetryRequest=!0,e.config.headers.Authorization="Bearer "+t.token,a()(e.config)}g()}));g()}if(403==e.response.status)return c["default"].prototype.$message({message:"失败！该操作无权限",type:"error"}),null}return""}));var p=function(){var e=new Date,t=window.localStorage.refreshtime?new Date(window.localStorage.refreshtime):new Date(-1),n=new Date(Date.parse(window.localStorage.TokenExpire)),r=1;t>=e?(t=e>n?e:n,t.setMinutes(t.getMinutes()+r),window.localStorage.refreshtime=t):window.localStorage.refreshtime=new Date(-1)},g=function(){i["a"].commit("saveToken",""),i["a"].commit("saveTokenExpire",""),i["a"].commit("saveTagsData",""),window.localStorage.removeItem("user"),window.localStorage.removeItem("NavigationBar"),s["a"].replace({path:"/login",query:{redirect:s["a"].currentRoute.fullPath}}),window.location.reload()},h={instance:function(){return f},baseInstance:function(){return m},get:function(e,t){return new Promise((function(n,r){f.get(e,t).then((function(e){n(e)})).catch((function(e){r(e)}))}))},post:function(e,t){return new Promise((function(n,r){f.post(e,t).then((function(e){n(e)})).catch((function(e){r(e)}))}))},put:function(e,t){return new Promise((function(n,r){f.put(e,t).then((function(e){n(e)})).catch((function(e){r(e)}))}))},delete:function(e,t){return new Promise((function(n,r){f.delete(e,t).then((function(e){n(e)})).catch((function(e){r(e)}))}))}};t["a"]=h},3786:function(e,t,n){"use strict";var r=n("365c"),a={getToken:function(e){return r["a"].get("auth/Token",e)},refreshToken:function(e){return r["a"].get("auth/RefreshToken",e)}};t["a"]=a},7752:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"crumbs"},[n("el-breadcrumb",{attrs:{separator:"/"}},[n("el-breadcrumb-item",[n("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 角色管理")]),n("el-breadcrumb-item",[e._v("添加/编辑角色")])],1)],1),n("div",{staticClass:"container"},[n("div",{staticClass:"form-box"},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"150px"}},[n("el-form-item",{attrs:{label:"角色名称",prop:"Name"}},[n("el-input",{model:{value:e.form.Name,callback:function(t){e.$set(e.form,"Name",t)},expression:"form.Name"}})],1),n("el-form-item",{attrs:{label:"是否启用"}},[n("el-switch",{model:{value:e.form.Enabled,callback:function(t){e.$set(e.form,"Enabled",t)},expression:"form.Enabled"}})],1),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{model:{value:e.form.Description,callback:function(t){e.$set(e.form,"Description",t)},expression:"form.Description"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保 存")])],1)],1)],1)])])},a=[],o=n("cc5e"),s={name:"role",data:function(){return{form:{Name:"",Enabled:!1,Description:""},id:-1,rules:{Name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]}}},methods:{init:function(){this.id>0&&this.getRole(this.id)},getRole:function(e){var t=this;o["a"].get(e).then((function(e){var n=e.data;n.success?t.form=n.data:t.$message({message:"获取角色信息失败",type:"error"})})).catch((function(e){t.$message({message:"获取角色信息失败",type:"error"})}))},onSubmit:function(){var e=this;e.$refs["form"].validate((function(t){t&&(e.id>0?(e.form.Id=e.id,o["a"].update(e.form).then((function(t){console.log(t);var n=t.data;n.success&&e.$message({message:"添加成功",type:"success"})})).catch((function(t){e.$message({message:t,type:"error"}),console.log(t)}))):(console.log("编辑"),o["a"].add(e.form).then((function(t){console.log(t);var n=t.data;n.success&&e.$message({message:"修改成功",type:"success"})})).catch((function(t){e.$message({message:t,type:"error"}),console.log(t)}))))}))}},created:function(){var e=this.$route.params.id;e&&(this.id=parseInt(e)),this.init()}},i=s,c=n("2877"),u=Object(c["a"])(i,r,a,!1,null,null,null);t["default"]=u.exports},cc5e:function(e,t,n){"use strict";var r=n("365c"),a={get:function(e){return r["a"].get("role",{params:{id:e}})},add:function(e){return r["a"].post("role",e)},update:function(e){return r["a"].put("role",e)},delete:function(e){return r["a"].delete("role",{params:{id:e}})},deleteAll:function(e){return r["a"].delete("role/deleteall",{params:{ids:e}})},getPageList:function(e){return r["a"].get("role/pagelist",{params:e})},getList:function(e){return r["a"].get("role/list",{params:e})}};t["a"]=a}}]);