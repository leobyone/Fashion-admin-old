(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b4e6343"],{"0feb":function(e,t,r){"use strict";var n=r("365c"),s={get:function(e){return n["a"].get("permission",{params:{id:e}})},add:function(e){return n["a"].post("permission",e)},update:function(e){return n["a"].put("permission",e)},delete:function(e){return n["a"].delete("permission",{params:{id:e}})},deleteAll:function(e){return n["a"].delete("permission/deleteall",{params:{ids:e}})},getPageList:function(e){return n["a"].get("permission/pagelist",{params:e})},getList:function(e){return n["a"].get("permission/list",{params:e})},getPermissionIdsByRoleId:function(e){return n["a"].get("permission/permissionidsbyroleid",{params:{roleId:e}})},getPermissionListByUserId:function(e){return n["a"].get("permission/permissionlistbyuserid",{params:{userId:e}})},assignPermission:function(e){return n["a"].post("permission/assign",e)}};t["a"]=s},1923:function(e,t,r){"use strict";var n=r("f6e6"),s=r.n(n);s.a},"365c":function(e,t,r){"use strict";r("a481");var n=r("bc3a"),s=r.n(n),a=r("3786"),o=r("41cb"),i=r("c0d6"),u=r("a026"),c="",l={baseURL:c+"/api"},m=s.a.create(l),f=s.a.create(),d=i["a"];m.interceptors.request.use((function(e){var t=new Date,r=new Date(Date.parse(d.state.tokenExpire));return d.state.token&&t<r&&d.state.tokenExpire&&(e.headers.Authorization="Bearer "+d.state.token),p(),e}),(function(e){return Promise.reject(e)})),m.interceptors.response.use((function(e){return e}),(function(e){var t=e.config;if("ECONNABORTED"==e.code&&-1!=e.message.indexOf("timeout")&&!t._retry)return u["default"].prototype.$message({message:"请求超时！",type:"error"}),t._retry=!0,null;if(e.response){if(401==e.response.status){var r=new Date,n=new Date(Date.parse(window.localStorage.refreshtime));if(window.localStorage.refreshtime&&r<=n)return a["a"].refreshToken({token:window.localStorage.Token}).then((function(t){if(t.success){u["default"].prototype.$message({message:"refreshToken success! loading data...",type:"success"}),i["a"].commit("saveToken",t.token);var r=new Date,n=new Date(r.setSeconds(r.getSeconds()+t.expires_in));return i["a"].commit("saveTokenExpire",n),e.config.__isRetryRequest=!0,e.config.headers.Authorization="Bearer "+t.token,s()(e.config)}g()}));g()}if(403==e.response.status)return u["default"].prototype.$message({message:"失败！该操作无权限",type:"error"}),null}return""}));var p=function(){var e=new Date,t=window.localStorage.refreshtime?new Date(window.localStorage.refreshtime):new Date(-1),r=new Date(Date.parse(window.localStorage.TokenExpire)),n=1;t>=e?(t=e>r?e:r,t.setMinutes(t.getMinutes()+n),window.localStorage.refreshtime=t):window.localStorage.refreshtime=new Date(-1)},g=function(){i["a"].commit("saveToken",""),i["a"].commit("saveTokenExpire",""),i["a"].commit("saveTagsData",""),window.localStorage.removeItem("user"),window.localStorage.removeItem("NavigationBar"),o["a"].replace({path:"/login",query:{redirect:o["a"].currentRoute.fullPath}}),window.location.reload()},w={instance:function(){return m},baseInstance:function(){return f},get:function(e,t){return new Promise((function(r,n){m.get(e,t).then((function(e){r(e)})).catch((function(e){n(e)}))}))},post:function(e,t){return new Promise((function(r,n){m.post(e,t).then((function(e){r(e)})).catch((function(e){n(e)}))}))},put:function(e,t){return new Promise((function(r,n){m.put(e,t).then((function(e){r(e)})).catch((function(e){n(e)}))}))},delete:function(e,t){return new Promise((function(r,n){m.delete(e,t).then((function(e){r(e)})).catch((function(e){n(e)}))}))}};t["a"]=w},3786:function(e,t,r){"use strict";var n=r("365c"),s={getToken:function(e){return n["a"].get("auth/Token",e)},refreshToken:function(e){return n["a"].get("auth/RefreshToken",e)}};t["a"]=s},a55b:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"login-wrap"},[r("div",{staticClass:"ms-login"},[r("div",{staticClass:"ms-title"},[e._v(e._s(e.$t("i18n.system")))]),r("el-form",{ref:"form",staticClass:"ms-content",attrs:{model:e.form,rules:e.rules,"label-width":"0px"}},[r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{attrs:{placeholder:e.$t("i18n.username")},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[r("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-people"},slot:"prepend"})],1)],1),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:e.$t("i18n.password")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("form")}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[r("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-lock"},slot:"prepend"})],1)],1),r("div",{staticClass:"login-btn"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v(e._s(e.$t("i18n.login")))])],1)],1)],1)])},s=[],a=(r("a481"),r("3786")),o=r("c24f"),i=r("0feb"),u={data:function(){return{loading:!1,form:{username:"",password:""},rules:{username:[{required:!0,message:this.$t("i18n.enterusername"),trigger:"blur"}],password:[{required:!0,message:this.$t("i18n.enterpassword"),trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;t.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,a["a"].getToken({params:{name:t.form.username,pwd:t.form.password}}).then((function(e){t.loading=!1;var r=e.data;if(r.success){var n=r.token;t.$store.commit("saveToken",n);var s=new Date,a=new Date(s.setSeconds(s.getSeconds()+r.expires_in));t.$store.commit("saveTokenExpire",a),window.localStorage.refreshtime=a,window.localStorage.expires_in=r.expires_in,t.getUserByToken(n)}else t.$message({message:r.message,type:"error"})}))}))},getUserByToken:function(e){var t=this;o["a"].getUserByToken(e).then((function(e){var r=e.data;r.success?r.data.Id>0&&(window.localStorage.user=JSON.stringify(r.data),t.getNavigationBar(r.data.Id)):t.$message({message:r.message,type:"error"})}))},getNavigationBar:function(e){var t=this;i["a"].getPermissionListByUserId(e).then((function(e){t.loading=!1;var r=e.data;if(r.success){var n=JSON.parse(window.localStorage.user?window.localStorage.user:null);t.$notify({type:"success",message:t.$t("i18n.logintips").replace("$user",n.LoginName),duration:6e3}),window.localStorage.NavigationBar=JSON.stringify(r.data),t.$router.replace(t.$route.query.redirect?t.$route.query.redirect:"/")}else t.$message({message:r.message,type:"error"})}))}}},c=u,l=(r("1923"),r("2877")),m=Object(l["a"])(c,n,s,!1,null,"4c973fb1",null);t["default"]=m.exports},c24f:function(e,t,r){"use strict";var n=r("365c"),s={getUserByToken:function(e){return n["a"].get("user/getbytoken",{params:{token:e}})},get:function(e){return n["a"].get("user",{params:{id:e}})},add:function(e){return n["a"].post("user",e)},update:function(e){return n["a"].put("user",e)},delete:function(e){return n["a"].delete("user",{params:{id:e}})},deleteAll:function(e){return n["a"].delete("user/deleteall",{params:{ids:e}})},getPageList:function(e){return n["a"].get("user/pagelist",{params:e})}};t["a"]=s},f6e6:function(e,t,r){}}]);